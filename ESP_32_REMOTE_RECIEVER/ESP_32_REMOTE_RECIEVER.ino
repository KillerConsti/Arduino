/*
  This sketch is the same as the Font_Demo_3 example, except the fonts in this
  example are in a FLASH (program memory) array. This means that processors
  such as the STM32 series that are not supported by a SPIFFS library can use
  smooth (anti-aliased) fonts.
*/

/*
  There are four different methods of plotting anti-aliased fonts to the screen.

  This sketch uses method 3, the font characters are first plotted in a Sprite, then the
  Sprite is pushed to the screen. This method is very flexible and the Sprite can be
  created, deleted, resized as needed. To render anti-aliased fonts well the Sprite
  needs to be 16 bit.  The fonts will render in 1 bit per pixel sprites but there
  will then be no anti-aliasing. Using 1 bit per pixel Sprites is however useful
  to use the extended Unicode range in fonts on mono displays like ePaper.

  A single Sprite can be re-used for plotting different values and graphics to
  different positions on the screen. This makes this method a very powerful display tool,
  for example round buttons can be created, making use of transparent colour plotting.
  
*/

// A processing sketch to create new fonts can be found in the Tools folder of TFT_eSPI
// https://github.com/Bodmer/TFT_eSPI/tree/master/Tools/Create_Smooth_Font/Create_font

// This sketch uses font files created from the Noto family of fonts:
// https://www.google.com/get/noto/
#define TFT_ROT 0
#include <BLEDevice.h>
#include <BLEServer.h>
//#include <BLEUtils.h>
#include <BLE2902.h>
#include "NotoSansBold15.h"
#include "NotoSansBold36.h"
//#include "NotoSansMonoSCB20.h"
#include <pgmspace.h>
// The font names are arrays references, thus must NOT be in quotes ""
#define AA_FONT_SMALL NotoSansBold15
#define AA_FONT_LARGE NotoSansBold36
//#define AA_FONT_MONO NotoSansMonoSCB20  // NotoSansMono-SemiCondensedBold 20pt
#include <SPI.h>
#include <TFT_eSPI.h>  // Hardware-specific library
TFT_eSPI tft = TFT_eSPI();
TFT_eSprite spr = TFT_eSprite(&tft);  // Sprite class needs to be invoked

/* png stuff*/
//#include <PNGdec.h>
//#include <C:\Users\49151\Documents\Arduino\libraries\TJpg_Decoder\examples\FLash_array\Flash_Jpg\volleyball.h>
/*Fuchs kommt hierer <a href="https://de.freepik.com/vektoren-kostenlos/hand-bemalt-fuchsentwurf_975549.htm#query=fuchs%20svg&position=10&from_view=keyword&track=ais&uuid=67e8a5e5-30c4-4d4e-8363-bbf851c943e1">Bild von ajipebriana</a> auf Freepik
Bild von ajipebriana
</a>
 auf Freepik
 */
//#include <C:\Users\49151\Documents\Arduino\libraries\TJpg_Decoder\examples\FLash_array\Flash_Jpg\fox.h>
//PNG png; // PNG decoder inatance
const uint16_t volleyball[] PROGMEM = {
  61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 54970, 50744, 46518, 46518, 48631, 54905, 59163, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 50744, 35953, 38034, 42292, 42292, 40147, 29582, 8453, 4326, 6505, 6506, 14826, 31695, 46486, 61277, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 57083, 38066, 38066, 54938, 63422, 65535, 65535, 65535, 65535, 65535, 65503, 57083, 46518, 29582, 6506, 8686, 8653, 6473, 16902, 35952, 52825, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 57083, 38066, 44373, 61309, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 59196, 44373, 16938, 8653, 33767, 63304, 50663, 33804, 52825, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 46486, 38066, 61309, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 63389, 38034, 46438, 65351, 65318, 63272, 44327, 40146, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 35953, 50744, 65535, 65535, 65535, 65535, 65535, 65535, 63390, 61309, 57083, 54970, 54970, 57083, 61277, 63390, 65503, 65535, 65535, 65535, 61309, 31723, 63272, 65318, 65318, 65350, 65350, 54888, 33806, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 59196, 33808, 59196, 65535, 65535, 63390, 54937, 44373, 35919, 35946, 42248, 44357, 50662, 52743, 52743, 50662, 46437, 42248, 35946, 35887, 44373, 54970, 35919, 59080, 65350, 65318, 65350, 65318, 65318, 65318, 59080, 33772, 61276, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 59164, 33808, 61309, 65502, 50744, 35919, 38023, 50663, 59080, 65352, 65350, 65350, 65318, 65318, 65350, 65318, 65318, 65318, 65350, 65351, 65352, 59081, 23236, 54888, 65350, 65318, 65318, 65318, 65318, 65318, 65350, 65350, 61160, 31692, 61277, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61277, 33808, 59196, 46518, 33802, 50663, 63272, 65350, 65318, 65350, 65318, 65318, 65318, 65350, 65350, 65350, 65350, 65350, 65318, 65318, 65318, 65351, 40134, 50695, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65351, 31691, 33807, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 33840, 44373, 33770, 54888, 65351, 65350, 65350, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65351, 42214, 50663, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65350, 65318, 57000, 46486, 57051, 38066, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 44405, 16935, 46439, 63304, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65350, 65351, 44294, 48551, 65351, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65350, 40135, 59196, 65535, 48631, 50712, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 57051, 19012, 56936, 65351, 65350, 65350, 65319, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65350, 65351, 42246, 48551, 65350, 65318, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 59080, 38065, 65535, 65535, 65535, 35953, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 31726, 59048, 65318, 65350, 65318, 65318, 65318, 65350, 65350, 65350, 65351, 65351, 63303, 63304, 65352, 65351, 65318, 65350, 65350, 65351, 42246, 48583, 65351, 65318, 65318, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65351, 35943, 61276, 65535, 65535, 65535, 61309, 35953, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 50744, 48551, 65350, 65318, 65318, 65318, 65318, 65350, 61192, 50663, 40101, 35911, 37990, 38054, 40102, 35942, 35910, 42246, 54855, 63272, 38021, 50663, 65351, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65350, 52743, 46518, 65535, 65535, 65535, 65535, 65535, 48599, 52825, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 33806, 63304, 65319, 65318, 65350, 65350, 59080, 40103, 35953, 31719, 63272, 65351, 65351, 65350, 65350, 65351, 65352, 61160, 48551, 27461, 50664, 65318, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 59080, 33839, 65503, 65535, 65535, 65535, 65535, 65535, 63422, 33840, 61309, 61309, 61309, 61309, 61309, 61309, 57083, 46439, 65318, 65318, 65350, 63271, 44359, 38066, 59196, 65535, 35950, 65352, 65350, 65350, 65318, 65318, 65350, 65318, 65350, 65318, 50663, 52775, 65318, 65319, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 63271, 33802, 61309, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 50744, 52857, 61309, 61309, 61309, 61309, 61309, 42292, 59112, 65350, 65350, 61160, 33801, 52857, 65535, 65535, 65535, 44405, 59048, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65350, 61192, 40134, 65350, 65350, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65351, 37992, 57051, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 63422, 33840, 61309, 61309, 61309, 61309, 61309, 35914, 65351, 65350, 59112, 31692, 61276, 65535, 65535, 65535, 65535, 59164, 46439, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65351, 33798, 63272, 65318, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 63303, 40103, 52857, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 38066, 57083, 61309, 61309, 61309, 59163, 46407, 65318, 61192, 29578, 61277, 65535, 65535, 65535, 65535, 65535, 65535, 33836, 65351, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 52711, 50663, 65350, 65318, 65350, 65318, 65318, 65318, 65318, 63271, 38023, 52825, 65503, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65503, 21130, 44373, 61309, 61309, 61309, 48599, 54855, 65351, 35878, 23276, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 44437, 56967, 65318, 65351, 65318, 65318, 65318, 65318, 65318, 65318, 65352, 33765, 65351, 65350, 65350, 65350, 65350, 65350, 63271, 35912, 54938, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 50711, 8620, 23309, 61309, 61309, 61309, 42260, 61160, 50663, 6539, 10666, 65503, 65535, 65535, 65535, 65535, 65535, 65535, 59196, 42215, 65350, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65350, 46439, 54856, 65350, 65350, 65318, 65350, 59080, 33803, 57083, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 61309, 19083, 8719, 4425, 59196, 61309, 61309, 35920, 63305, 21127, 8719, 6506, 61277, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 35919, 63271, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 61191, 33829, 65351, 65350, 65351, 52743, 35919, 61309, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65503, 33808, 8685, 8687, 8620, 52825, 61309, 61309, 33837, 50696, 8620, 8687, 6572, 54938, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 52857, 48583, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65350, 46439, 52775, 61191, 38023, 44405, 65503, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 42292, 8620, 8687, 8687, 8653, 48599, 61309, 61309, 35916, 29608, 10767, 8687, 8654, 44405, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65503, 33803, 65351, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65350, 63271, 29541, 33839, 59164, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 48598, 8587, 8719, 8687, 8687, 8686, 44405, 61309, 61309, 27467, 6505, 8719, 8687, 10767, 31695, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 48631, 54856, 65350, 65318, 65318, 65318, 65318, 65318, 65350, 65350, 65350, 52743, 48599, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 48599, 8586, 8719, 8687, 8687, 8719, 8686, 44405, 61309, 61309, 25421, 8620, 8687, 8687, 8687, 10665, 63422, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 63422, 33769, 65351, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65351, 35880, 61309, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 46486, 6506, 8687, 8719, 8687, 8687, 8687, 8653, 48631, 61309, 61309, 31727, 8653, 8687, 8687, 8687, 6540, 54938, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 48599, 54856, 65318, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 59080, 35952, 65503, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65503, 42260, 8587, 8719, 8687, 8687, 8687, 8687, 8687, 6539, 54970, 61309, 61309, 40179, 8686, 8687, 8687, 8687, 8687, 40147, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 63422, 33802, 63304, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 48551, 48663, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 63390, 31760, 8620, 8719, 8687, 8687, 8687, 8687, 8687, 8719, 10600, 61309, 61309, 61309, 44405, 8653, 8687, 8687, 8687, 8719, 16971, 65503, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 50712, 50663, 65318, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65351, 37992, 59164, 65535, 65535, 65535, 65535, 65535, 54970, 21196, 8686, 8687, 8687, 8687, 8687, 8687, 8687, 8687, 8588, 33808, 61309, 61309, 61309, 50712, 8621, 8687, 8687, 8687, 8687, 8620, 52857, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65503, 31725, 63272, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 63239, 31724, 63390, 65535, 65535, 63422, 44373, 8586, 8687, 8687, 8687, 8687, 8687, 8687, 8687, 8687, 8686, 25351, 42293, 61309, 61309, 61309, 54970, 6539, 8687, 8687, 8687, 8687, 8719, 31728, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 54938, 44327, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 56968, 35920, 63422, 52825, 23276, 8653, 8719, 8687, 8687, 8687, 8687, 8687, 8687, 8687, 8686, 21127, 48617, 48631, 61309, 61309, 61309, 61309, 6473, 8687, 8687, 8687, 8687, 8687, 6474, 57083, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 40146, 59080, 65318, 65350, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65350, 52776, 19016, 8587, 8719, 8687, 8687, 8687, 8687, 8687, 8687, 8687, 8687, 8719, 12744, 54920, 46439, 57051, 61309, 61309, 61309, 61309, 29615, 10767, 8687, 8687, 8687, 8687, 8686, 35953, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 61309, 33801, 63303, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65350, 50664, 8586, 10767, 8719, 8687, 8687, 8687, 8687, 8687, 8687, 8719, 10633, 52744, 65351, 33801, 61309, 61309, 61309, 61309, 61309, 48599, 8653, 8687, 8687, 8687, 8687, 8719, 8618, 59164, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 52825, 46471, 65351, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65351, 50664, 10665, 8719, 8687, 8687, 8687, 8687, 8687, 8719, 12713, 52744, 65351, 59080, 42260, 61309, 61309, 61309, 61309, 61309, 61309, 10666, 8687, 8687, 8687, 8687, 8687, 8686, 31728, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 38065, 56968, 65350, 65350, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65350, 54888, 19015, 8654, 8687, 8719, 8687, 8686, 14824, 54856, 65350, 65318, 44358, 57083, 61309, 61309, 61309, 61309, 61309, 61309, 38001, 8686, 8687, 8687, 8687, 8687, 8687, 6507, 52857, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 63390, 31756, 63239, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65350, 65350, 61160, 35910, 8553, 8621, 8588, 25383, 59080, 65350, 65350, 61192, 35919, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61277, 8585, 8687, 8687, 8687, 8687, 8687, 8687, 19083, 63390, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 57083, 38024, 65351, 65318, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65351, 59047, 50631, 54855, 63271, 65350, 65318, 65351, 44327, 57051, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 42292, 8653, 8687, 8687, 8687, 8687, 8687, 8653, 38034, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 50744, 44326, 65351, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65350, 65319, 65318, 65318, 57000, 38066, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 25389, 8687, 8687, 8687, 8687, 8687, 8687, 6539, 48663, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 44405, 50631, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65319, 65350, 65318, 63272, 31723, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 59164, 12745, 8719, 8687, 8687, 8687, 8687, 8719, 10633, 57050, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 40147, 52744, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65351, 38023, 57051, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 54938, 8585, 8719, 8687, 8687, 8687, 8687, 8687, 16970, 57115, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65503, 40146, 52744, 65350, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65318, 65350, 65318, 65350, 65351, 40135, 52825, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 50744, 10666, 8719, 8687, 8687, 8687, 8687, 8687, 19051, 59196, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65503, 42260, 48519, 65351, 65318, 65350, 65318, 65318, 65318, 65318, 65318, 65350, 65318, 63271, 40102, 50712, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 52889, 16938, 8686, 8687, 8687, 8687, 8687, 8687, 16938, 57051, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 48599, 40103, 63272, 65318, 65350, 65318, 65318, 65318, 65350, 65350, 59111, 33800, 52857, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 29614, 8588, 10767, 8687, 8687, 8687, 8687, 12746, 48631, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 57051, 33804, 52775, 63303, 65350, 65318, 65318, 65351, 50663, 33839, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 48599, 14858, 8653, 10767, 8719, 8687, 8719, 8587, 35953, 63390, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 63422, 48599, 33803, 48551, 56935, 54856, 33801, 48631, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 42260, 14858, 8621, 10735, 8719, 8719, 8686, 14858, 46518, 63422, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 63422, 44372, 14823, 42260, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 50744, 31695, 8586, 8620, 8686, 10767, 8653, 19083, 44405, 59164, 65535, 65535, 65535, 65535, 61277, 52825, 40179, 35921, 50744, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 52825, 44373, 33808, 19051, 12778, 8518, 4258, 23243, 35921, 33808, 35953, 44373, 52825, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309
};
/*53 * 50*/
const uint16_t fox_pic[] PROGMEM = {
  61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 54970, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 54905, 50052, 52825, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 54905, 45924, 47909, 50581, 61309, 61309, 61309, 61309, 61309, 61309, 57050, 37772, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61277, 52165, 41701, 49989, 50581, 61309, 61309, 61309, 61309, 61309, 48533, 50052, 39588, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 48205, 52164, 45829, 49989, 50581, 61309, 61309, 61309, 61309, 48501, 56324, 39621, 39554, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 50646, 60484, 47972, 49989, 49989, 48533, 61309, 61309, 61309, 52792, 58404, 50052, 49989, 43980, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 50118, 62564, 45860, 49989, 49989, 52825, 61309, 61309, 59164, 43912, 56292, 43780, 49989, 44046, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 48468, 62564, 62564, 43781, 43749, 41701, 48107, 48005, 56292, 56324, 58404, 56324, 52164, 41732, 42064, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 50083, 60484, 47972, 47972, 58404, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 46027, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 50646, 50052, 50052, 60516, 62564, 62564, 62564, 62564, 62564, 60484, 56324, 60484, 58436, 62564, 56324, 56292, 52825, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 39852, 58404, 62564, 62564, 62564, 62564, 62564, 60484, 48272, 54938, 59131, 46486, 50084, 62564, 47972, 46486, 40179, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 46124, 60484, 62564, 62564, 60484, 54244, 62564, 62564, 54244, 57083, 65535, 46486, 27469, 58404, 62564, 43812, 48599, 50712, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 48205, 62564, 62564, 62564, 60484, 45924, 62564, 62564, 62564, 62564, 52131, 48500, 54970, 41931, 62564, 62564, 58404, 44144, 46486, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 44307, 58404, 62564, 62564, 60484, 41732, 60484, 62564, 62564, 62564, 62564, 62564, 62564, 58404, 60484, 62564, 62564, 60484, 48238, 52825, 52857, 48631, 25356, 40147, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 44275, 39752, 50084, 60484, 43781, 58404, 62564, 58404, 50185, 52366, 54212, 62564, 62564, 62564, 62564, 62564, 62564, 46191, 65503, 65535, 65535, 65503, 18952, 42292, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 48072, 62564, 62564, 52100, 39652, 45924, 50482, 61277, 65535, 65535, 59196, 50613, 50285, 50052, 52164, 50084, 48303, 61309, 65535, 65535, 65535, 65535, 59196, 54938, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 50450, 62564, 60484, 45829, 33546, 50712, 59164, 65503, 65535, 65535, 65535, 65535, 65535, 65535, 63390, 63422, 65535, 65535, 65535, 65535, 65535, 65535, 52825, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 57051, 56324, 60516, 52100, 41933, 44308, 50712, 57051, 61309, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 61309, 54938, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 29220, 58404, 62564, 60484, 50021, 25061, 38001, 54938, 63422, 65535, 65535, 65535, 65503, 65535, 65535, 65535, 65503, 65503, 63390, 52857, 52825, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 52792, 47909, 39621, 58404, 62564, 60484, 54212, 43782, 42031, 44340, 54938, 61277, 63390, 61309, 59196, 57051, 54970, 52825, 46486, 48631, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 59196, 52200, 54180, 49989, 43749, 47972, 60484, 62564, 60516, 60484, 58404, 46224, 54970, 54970, 54938, 50744, 46486, 38034, 57051, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 59164, 50152, 62564, 62564, 58372, 52100, 49989, 41669, 52132, 62564, 62564, 62564, 48238, 54970, 54970, 54970, 54938, 44405, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 48565, 54212, 62564, 62564, 62564, 62564, 60516, 58372, 54148, 43749, 52132, 62564, 62564, 46355, 54970, 54970, 54970, 44405, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 52825, 46026, 60484, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 54180, 37541, 60516, 56292, 50744, 54970, 54970, 44373, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 57083, 48206, 58404, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 60484, 56260, 45829, 54244, 54412, 54970, 54970, 50712, 44373, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 48500, 54244, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 49989, 47877, 50084, 62565, 54970, 54970, 50712, 50744, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 44110, 60484, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 52100, 27141, 56324, 60652, 54970, 54970, 54970, 54938, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 46124, 60516, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 54212, 45892, 60516, 60720, 54970, 54970, 48599, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 44143, 60484, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 52132, 54244, 62564, 58836, 54970, 54970, 46486, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 57051, 52792, 50614, 52792, 54938, 61309, 61309, 61309, 61309, 61309, 50646, 58436, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 47972, 58436, 62564, 58869, 54970, 50712, 48599, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 50646, 50085, 58404, 62564, 62564, 62564, 60452, 47940, 41966, 54938, 61309, 61309, 50053, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 47972, 62564, 60619, 54970, 54938, 37740, 57083, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 59196, 48138, 60516, 62564, 62564, 62564, 62564, 60484, 56292, 52100, 49989, 45829, 48501, 50613, 62564, 62564, 62564, 62564, 60452, 56292, 56292, 58372, 60516, 62564, 62564, 60516, 62564, 62564, 62564, 62564, 62564, 60484, 56324, 62564, 56854, 54938, 39918, 39655, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 50120, 62564, 62564, 62564, 62564, 60484, 54180, 49989, 49989, 49989, 49989, 49989, 47909, 47972, 62564, 62564, 60516, 50020, 41701, 45892, 45892, 39621, 49989, 58404, 62564, 54244, 62564, 62564, 62564, 62564, 62564, 60484, 62564, 52332, 48599, 39820, 50020, 48402, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 46224, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 58404, 52100, 49989, 49989, 45829, 58404, 62564, 62564, 47940, 54244, 62564, 62564, 62564, 60484, 47972, 45829, 60484, 52132, 62564, 62564, 62564, 62564, 62564, 62564, 50084, 43947, 45829, 54180, 60484, 52824, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 57051, 56324, 62564, 62564, 62564, 62564, 62564, 62564, 60516, 56292, 49989, 49989, 49989, 49989, 43749, 56292, 60516, 58404, 60484, 62564, 62564, 62564, 62564, 62564, 62564, 45892, 54180, 45892, 62564, 62564, 62564, 62564, 62564, 58436, 43749, 49989, 58372, 60452, 54244, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 50483, 62564, 62564, 62564, 62564, 62564, 62564, 60516, 54180, 49989, 49989, 49989, 49989, 49989, 49989, 49989, 49989, 49989, 49989, 52100, 56292, 60516, 62564, 62564, 62564, 58404, 43749, 47940, 62564, 62564, 62564, 62564, 62564, 45892, 49989, 52100, 52100, 60484, 50219, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 48071, 62564, 62564, 62564, 62564, 62564, 62564, 56292, 49989, 49989, 49989, 47909, 41669, 41669, 41669, 39588, 43749, 47909, 49989, 49989, 49989, 52100, 60484, 62564, 56292, 62564, 39589, 43780, 62564, 62564, 62564, 62564, 62564, 41669, 49989, 54180, 60484, 62564, 50515, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61277, 52132, 62564, 62564, 62564, 62564, 62564, 60484, 49989, 52100, 43781, 47972, 54244, 56324, 48238, 54970, 65535, 61309, 54970, 48501, 41801, 47909, 49989, 52069, 60484, 52068, 62564, 39589, 41669, 58404, 60484, 62564, 62564, 58404, 43749, 54180, 60516, 62564, 60484, 52792, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 52857, 49989, 60484, 62564, 62564, 62564, 62564, 60484, 60484, 56324, 62564, 62564, 62564, 46126, 65503, 65535, 65535, 65535, 65535, 65535, 65503, 48599, 41768, 49989, 52100, 49989, 54244, 43749, 39589, 54180, 56292, 62564, 60516, 54212, 35429, 50052, 41732, 50052, 39652, 57051, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 52825, 49989, 54180, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 60484, 48139, 52760, 63422, 65535, 65535, 65535, 65535, 65535, 63390, 44177, 47909, 49989, 45892, 49989, 45797, 45829, 41669, 41700, 52132, 16740, 14660, 25027, 27107, 29187, 18788, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 48599, 49989, 49989, 56292, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 60484, 41965, 65535, 65535, 65535, 65535, 65535, 65535, 65503, 46453, 47909, 41669, 49989, 49989, 31269, 33348, 12515, 29220, 10435, 27501, 12449, 12450, 12417, 10434, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 52792, 49989, 49989, 49989, 56324, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 58404, 46224, 63390, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 46453, 41669, 49989, 49989, 33348, 12450, 12417, 12417, 12450, 44405, 12450, 12417, 12417, 12482, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 57051, 47909, 49989, 49989, 49989, 54180, 60484, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 43946, 63422, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 44209, 49989, 45829, 20868, 10434, 12417, 12417, 12417, 50744, 25356, 12417, 12417, 12449, 52825, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 41670, 49989, 49989, 49989, 49989, 52069, 56292, 60484, 62564, 62564, 62564, 62564, 62564, 62564, 52132, 50384, 52759, 61309, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 63390, 31466, 10434, 12417, 10467, 12417, 12417, 12417, 40179, 57051, 12482, 12417, 12417, 25356, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 46420, 49989, 49989, 49989, 49989, 49989, 56260, 60484, 62564, 62564, 62564, 62564, 62564, 62564, 62564, 52164, 50548, 63390, 65503, 63390, 63390, 65535, 65535, 65535, 65535, 65535, 54938, 33775, 42292, 44373, 16871, 12417, 12417, 18952, 63422, 48631, 12482, 12417, 12450, 42260, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 41932, 49989, 49989, 49989, 49989, 49989, 49989, 54180, 56260, 56324, 58372, 58372, 48073, 44242, 52825, 57083, 54970, 54970, 54970, 54970, 54970, 54970, 57083, 59164, 61277, 63390, 50712, 61309, 61309, 59196, 23210, 10434, 10434, 48599, 61309, 57083, 52857, 54970, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 41835, 49989, 49989, 49989, 49989, 49989, 49989, 49989, 49989, 49989, 49989, 41768, 42097, 46518, 52857, 54970, 54970, 54970, 54970, 54970, 50712, 44373, 48599, 50712, 50744, 50712, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 44210, 45829, 49989, 49989, 49989, 49989, 49989, 49989, 49989, 49989, 49989, 49989, 37575, 50712, 54970, 52857, 44405, 48599, 52825, 61277, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 59196, 46355, 41736, 45829, 49989, 49989, 49989, 49989, 49989, 45829, 37804, 44405, 44405, 48631, 57051, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 59196, 52825, 50614, 48533, 50581, 48533, 48631, 54938, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309, 61309
};

const uint8_t xpos_volleyball = 15;
const uint8_t ypos_volleyball = 115;
const uint8_t xpos_fox = 170;
const uint8_t ypos_fox = 115;


//tft in user_setup.h

const static uint8_t RADIO_ID = 0;
const static uint8_t PIN_RADIO_CE = 26;
const static uint8_t PIN_RADIO_CSN = 27;
const static uint8_t PIN_RADIO_MOSI = 23;
const static uint8_t PIN_RADIO_MISO = 19;
const static uint8_t PIN_RADIO_SCK = 18;
const static uint8_t PIN_RADIO_IRQ = 25;
//drehschalter
volatile uint8_t _dataWasReceived; // Note usage of volatile since the variable is used in the radio interrupt
                                   // while also being used outside the interrupt.

struct Drehschalter
{
  //pins
  const uint8_t _CLK = 21;
  const uint8_t _DT = 5;
  const uint8_t _SW = 17;

  int DrehPosition = 0;
  int Relative_Position = LOW;
  int Old_Relative_Position = LOW;
  int CLK_Wert_n = LOW;
  int Current_Taster = LOW;
  int Old_Taster = LOW;
  bool WasUpdated = false;
  unsigned long ButtonPressedTime = 0;
  bool OnLongPressButton = false;
};
Drehschalter mDrehschalter;


bool m_init = false;

//CMDS
/*
CMD 0 = Request History and Score Data from Uno
CMD 1,T1_P,T2_P,S1_P,S2_P = Set New Score and Sets(Team1, Team2)
CMD 2,(0- or 1) -> Reset ->Soft (0) or Hard (1)
CMD3- Update History
  -T1 Points
  -T2 Points
  -Team Won (0 tie; 1 = T1; 2 = T2) -> if = 255 set is not counted
  -Set Number (duno if that works that smart)
CMD 3,T1,T2,TeamWon,Is Set
CMD4 -PartyMode

*/

struct __attribute__((packed)) Commandpackage  // Any packet up to 32 bytes can be sent.
{
  uint8_t CommandId = 0;
  uint8_t CommandArg1 = 0;
  uint8_t CommandArg2 = 0;
  uint8_t CommandArg3 = 0;
  uint8_t CommandArg4 = 0;
};
struct __attribute__((packed)) RadioScorePacket  // Any packet up to 32 bytes can be sent.
{
  uint8_t FromRadioId;
  uint8_t T1_Score;
  uint8_t T2_Score;
  uint8_t T1_Sets;
  uint8_t T2_Sets;
  uint32_t FailedTxCount;
};

//ScoreBoard
struct __attribute__((packed)) MatchDataLong  // Any packet up to 32 bytes can be sent.
{
  uint8_t MatchNum; //we can track 3 matches
  uint8_t type; //1-3 are current matchdata //4-6 are next match data
  char TeamName1[12];
  char TeamName2[12];
};

struct __attribute__((packed)) MatchDataShort  // Any packet up to 32 bytes can be sent.
{
  uint8_t FromRadioId;
  uint8_t MatchNum; //we can track 3 matches
  uint8_t T1_Score = 2;
  uint8_t T2_Score = 3;
  uint8_t T1_Sets = 1 ;
  uint8_t T2_Sets = 2;
  uint32_t FailedTxCount;
};

MatchDataLong mMatchDataLong;
 MatchDataShort mMatchDataShort;

/* Bluetooth */
/*
  Rui Santos
  Complete project details at https://RandomNerdTutorials.com/esp32-web-bluetooth/
  
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files.
  
  The above copyright notice and this permission notice shall be included in all
  copies or substantial portions of the Software.
*/



BLEServer* pServer = NULL;
BLECharacteristic* pSensorCharacteristic = NULL;

BLECharacteristic* pt1Characteristic = NULL;
BLECharacteristic* pt2Characteristic = NULL;
BLECharacteristic* ps1Characteristic = NULL;
BLECharacteristic* ps2Characteristic = NULL;
BLECharacteristic* cmdCharacteristic = NULL;
BLECharacteristic* TeamNameCharacteristic = NULL;
BLECharacteristic* TeamMathNumCharacteristics = NULL;
bool deviceConnected = false;
bool oldDeviceConnected = false;
uint32_t value = 0;
uint32_t m_BLETime = 0;
bool NeedToNotifyBLE = false;
bool NeedToNotifyTFT = false;
bool NeedToNotifyRadio = false;
bool mUpdateScreenColor = false;
//bool is stupid here
bool NeedToNotifyLEDShort;
//Need this 3 times
typedef struct
{
  uint8_t Team1;
  uint8_t Team2;
  uint8_t Satz;
  uint8_t Winner;  //0 is no winner 1 -> T1 ; 2 ->t2;
  bool Set = false;
} VolleyBallHistory;

struct ScoreBoard_over_Raio {
  uint8_t mT1 = 0;
  uint8_t mT2 = 0;
  uint8_t mS1 = 0;
  uint8_t mS2 = 0;
  char TeamName1[12];
  char TeamName2[12];
  VolleyBallHistory MyVolleyHistory[5];
  uint16_t BackgroundColor;
};

uint8_t mCurrentRadioID = 0;
//this id -1
ScoreBoard_over_Raio mRadioScores[3];
// See the following for generating UUIDs:
// https://www.uuidgenerator.net/
//up to 15 games (30/2)
char MatchNameData_Field1[12][30];
volatile int currentMatch_Field1= -1;
int mValidTeamNamesField1 = 30;
//char MatchNameData_Field2[12][30];
//char MatchNameData_Field3[12][30];
const uint16_t KC_grey = 2113;
const uint16_t KC_dirty_white = 61309;
const uint16_t KC_DARKGREY = 31727;

#define SERVICE_UUID "19b10000-e8f2-537e-4f6c-d104768a1214"
#define SENSOR_CHARACTERISTIC_UUID "19b10001-e8f2-537e-4f6c-d104768a1214"
#define T1_CHARACTERISTIC_UUID "19b10002-e8f2-537e-4f6c-d104768a1214"
#define T2_CHARACTERISTIC_UUID "19b10003-e8f2-537e-4f6c-d104768a1214"
#define S1_CHARACTERISTIC_UUID "19b10004-e8f2-537e-4f6c-d104768a1214"
#define S2_CHARACTERISTIC_UUID "19b10005-e8f2-537e-4f6c-d104768a1214"
#define CMD_CHARACTERISTIC_UUID "19b10005-e8f2-537e-4f6c-d104768a1215"
//this is for field 1
#define mTeamNameCharaceristic "19b10006-e8f2-537e-4f6c-d104768a1214"
#define mTeamMatchNumCharaceristic "19b10007-e8f2-537e-4f6c-d104768a1214"
class MyServerCallbacks : public BLEServerCallbacks {
  void onConnect(BLEServer* pServer) {
    deviceConnected = true;
    NeedToNotifyBLE = true;  //keep us updated pls
  };

  void onDisconnect(BLEServer* pServer) {
    deviceConnected = false;
  }
};

class MyCharacteristicCallbacks : public BLECharacteristicCallbacks {
  void onWrite(BLECharacteristic* pt1Characteristic) {
    String value = pt1Characteristic->getValue();
    if (value.length() > 0) {
      Serial.print("Characteristic event, written: ");
      Serial.println(static_cast<int>(value[0]));  // Print the integer value

      int receivedValue = static_cast<int>(value[0]);
      Serial.println(receivedValue);
      mRadioScores[mCurrentRadioID].mT1 = constrain(receivedValue, 0, 99);
      /*if (receivedValue == 1) {
                digitalWrite(ledPin, HIGH);
            } else {
                digitalWrite(ledPin, LOW);
            }*/
      NeedToNotifyRadio = true;
      NeedToNotifyBLE = true;
      NeedToNotifyTFT = true;
    }
  }
};
class MyCharacteristicCallbacks2 : public BLECharacteristicCallbacks {
  void onWrite(BLECharacteristic* pt2Characteristic) {
    String value = pt2Characteristic->getValue();
    if (value.length() > 0) {
      Serial.print("Characteristic event, written: ");
      Serial.println(static_cast<int>(value[0]));  // Print the integer value

      int receivedValue = static_cast<int>(value[0]);
      Serial.println(receivedValue);
      mRadioScores[mCurrentRadioID].mT2 = constrain(receivedValue, 0, 99);
      NeedToNotifyTFT = true;
      NeedToNotifyBLE = true;
      NeedToNotifyRadio = true;
      /*if (receivedValue == 1) {
                digitalWrite(ledPin, HIGH);
            } else {
                digitalWrite(ledPin, LOW);
            }*/
    }
  }
};
class MyCharacteristicCallbacks3 : public BLECharacteristicCallbacks {
  void onWrite(BLECharacteristic* ps1Characteristic) {
    String value = ps1Characteristic->getValue();
    if (value.length() > 0) {
      Serial.print("Characteristic event, written: ");
      Serial.println(static_cast<int>(value[0]));  // Print the integer value

      int receivedValue = static_cast<int>(value[0]);
      Serial.println(receivedValue);
      mRadioScores[mCurrentRadioID].mS1 = constrain(receivedValue, 0, 3);
      NeedToNotifyTFT = true;
      NeedToNotifyBLE = true;
      NeedToNotifyRadio = true;
      /*if (receivedValue == 1) {
                digitalWrite(ledPin, HIGH);
            } else {
                digitalWrite(ledPin, LOW);
            }*/
    }
  }
};
class MyCharacteristicCallbacks4 : public BLECharacteristicCallbacks {
  void onWrite(BLECharacteristic* ps2Characteristic) {
    String value = ps2Characteristic->getValue();
    if (value.length() > 0) {
      Serial.print("Characteristic event, written: ");
      Serial.println(static_cast<int>(value[0]));  // Print the integer value

      int receivedValue = static_cast<int>(value[0]);
      Serial.println(receivedValue);
      mRadioScores[mCurrentRadioID].mS2 = constrain(receivedValue, 0, 3);
      NeedToNotifyTFT = true;
      NeedToNotifyBLE = true;
      NeedToNotifyRadio = true;
      /*if (receivedValue == 1) {
                digitalWrite(ledPin, HIGH);
            } else {
                digitalWrite(ledPin, LOW);
            }*/
    }
  }
};



struct __attribute__((packed)) RadioHistoryPacket  // Any packet up to 32 bytes can be sent.
{
  uint8_t FromRadioId;
  VolleyBallHistory myVolleyBallHistory[5];
  uint32_t FailedTxCount;
};
#include "NRFLite.h"
NRFLite _radio;
RadioScorePacket _radioData;
RadioHistoryPacket _radioHistoryData;
Commandpackage _radioCmdData;

struct CommandMsg {
  bool MessageRecieved;
  int CommandId = 0;
  int Arg1 = 0;
};

CommandMsg CommandMode;
class MyCharacteristicCallbacksCMD
  : public BLECharacteristicCallbacks {
  void onWrite(BLECharacteristic* cmdCharacteristic) {
    String value = cmdCharacteristic->getValue();
    if (value.length() > 0) {

      Serial.print("Characteristic event (button), written: ");
      Serial.println(static_cast<int>(value[0]));  // Print the integer value

      int mreceivedValue = static_cast<int>(value[0]);
      Serial.println(mreceivedValue);
      if (mreceivedValue == 0)  //soft
      {
        CommandMode.CommandId = 2;
        CommandMode.Arg1 = 0;
        CommandMode.MessageRecieved = true;
      } else if (mreceivedValue == 1) {
        CommandMode.CommandId = 2;
        CommandMode.Arg1 = 1;
        CommandMode.MessageRecieved = true;
      } else if (mreceivedValue == 2)  //PartyModeOn
      {
        CommandMode.CommandId = 4;
        CommandMode.Arg1 = 1;
        CommandMode.MessageRecieved = true;
      } else if (mreceivedValue == 3) {
        if (mCurrentRadioID == 0) {
          return;
        }
        mCurrentRadioID = 0;
        mUpdateScreenColor = true;
      } else if (mreceivedValue == 4) {
        if (mCurrentRadioID == 1) {
          return;
        }
        mCurrentRadioID = 1;
        mUpdateScreenColor = true;
      } else if (mreceivedValue == 5) {
        if (mCurrentRadioID == 2) {
          return;
        }
        mCurrentRadioID = 2;
        mUpdateScreenColor = true;
      }
    }
  }
};

/*
The problem is Serial.print when you pass a char * argument, it expects the array to have a null byte to denote the end of the string. Even though you passed a char array, what is passed is a char pointer (i.e. the array bounds are not passed). If you bump up the size of the arrays, and add an explicit null byte, it should print fine. You can use either '\0' or just 0 to represent a null byte, i.e.:
*/
volatile bool NeedToSendMachData_1_CurrentMatch = false;
volatile bool NeedToSendMachData_1_NextMatch = false;
volatile bool NeedToSendMachData_2_CurrentMatch = false;
volatile bool NeedToSendMachData_2_NextMatch = false;
void SetCurrentMatchField1(int mMatchNum)
{
  //Serial.println(mMatchNum);
  if(mMatchNum < 0 || mMatchNum > (mValidTeamNamesField1 /2))
  {
    Serial.println("SetCurrentMatchField1 invalid Matchnum");
    return;
  }
  //copy data
  for(size_t t=0; t <12; t++)
  {
    mMatchDataLong.TeamName1[t] = MatchNameData_Field1[t][mMatchNum*2];
    mMatchDataLong.TeamName2[t] = MatchNameData_Field1[t][mMatchNum*2+1];
  }
  //mMatchDataLong.TeamName1[11] = '\0';
  //mMatchDataLong.TeamName2[11] = '\0';
  currentMatch_Field1 = mMatchNum;
  //send data

  mMatchDataLong.MatchNum =mMatchNum;
  mMatchDataLong.type = 1;
  Serial.println(mMatchDataLong.MatchNum);
  Serial.println(mMatchDataLong.type);
  //Serial.println(mMatchDataLong.TeamName1);
  //Serial.println(mMatchDataLong.TeamName2);
    if(_radio.send(8, &mMatchDataLong, sizeof(mMatchDataLong)))
  {
    Serial.println("...success");
  }
  else
  {
    Serial.println("...fail");
  }
  Serial.println("send stuff");
}

void SetNextMatchField1(int mMatchNumCurrentMatch)
{
  //Serial.println(mMatchNum);
  int NextMatchNum = mMatchNumCurrentMatch+1;
  if(NextMatchNum < 0 || NextMatchNum > (mValidTeamNamesField1 /2))
  {
    Serial.println("SetNextMatchField1 invalid Matchnum");
    return;
  }
  //copy data
  for(size_t t=0; t <12; t++)
  {
    mMatchDataLong.TeamName1[t] = MatchNameData_Field1[t][NextMatchNum*2];
    mMatchDataLong.TeamName2[t] = MatchNameData_Field1[t][NextMatchNum*2+1];
  }
  //mMatchDataLong.TeamName1[11] = '\0';
  //mMatchDataLong.TeamName2[11] = '\0';
  currentMatch_Field1 = mMatchNumCurrentMatch;
  //send data

  mMatchDataLong.MatchNum =NextMatchNum;
  mMatchDataLong.type = 4;
  //Serial.println(mMatchDataLong.TeamName1);
  //Serial.println(mMatchDataLong.TeamName2);
    if(_radio.send(8, &mMatchDataLong, sizeof(mMatchDataLong)))
  {
    Serial.println("...success");
  }
  else
  {
    Serial.println("...fail");
  }
  Serial.println("send stuff");
}
class MyCharacteristicCallbacksTeamMatch1
 : public BLECharacteristicCallbacks {
  void onWrite(BLECharacteristic* TeamMathNumCharacteristics) {
    String value = TeamMathNumCharacteristics->getValue();
    int mreceivedValue = 0;
    if (value.length() > 0) {
     mreceivedValue = static_cast<int>(value[0]);
      if(value.length() == 2)
      {
        mreceivedValue = mreceivedValue*10;
      mreceivedValue +=static_cast<int>(value[1]);
      }
        Serial.print("recieved  new current match 1 value");
      Serial.println(mreceivedValue);
      currentMatch_Field1 = mreceivedValue;
      NeedToSendMachData_1_CurrentMatch = true;
       NeedToSendMachData_1_NextMatch =true;
    }
  }
 };

class MyCharacteristicCallbacksTeamNames
  : public BLECharacteristicCallbacks {
  void onWrite(BLECharacteristic* TeamNameCharacteristic) {
    String value = TeamNameCharacteristic->getValue();
    if (value.length() > 0) {
      //write everything into MatchNameData_Field1
      int TeamnameNumber =0;
      //Serial.print("Team Names written: ");
      //Serial.println(value);  // Print the integer value
      Serial.println(TeamNameCharacteristic->getLength());
      char TeamName[13];
      int LastFinish = 0;
      for(size_t t= 0 ; t < TeamNameCharacteristic->getLength();t++)
      {
        //Serial.print(t);
        //Serial.print(" ");
        //Serial.println(value[t]);
        char CurrentVal = value[t];
        if(CurrentVal ==':')
        {
          for(size_t u = t-LastFinish ; u < 12;u++)
          {
            TeamName[u] = ' ';
            MatchNameData_Field1[u][TeamnameNumber] = ' ';
          }
          TeamName[12] = '\0';
          Serial.println(TeamName);
          LastFinish =t+1;
          TeamnameNumber++;
          continue;
        }
        else if (CurrentVal =='\n')
        {
          Serial.print("found new line ");
                    for(size_t u = t-LastFinish ; u < 12;u++)
                              {
            TeamName[u] = ' ';
            MatchNameData_Field1[u][TeamnameNumber] = ' ';
            
          }
          TeamName[12] = '\0';
          Serial.println(TeamName);
          TeamnameNumber++;

          LastFinish =t+1;
          continue;
        }
        else 
        {
          if(t-LastFinish > 11) //Limit of 12 chars
          continue;
          TeamName[t-LastFinish] = value[t];
          MatchNameData_Field1[t-LastFinish][TeamnameNumber] = value[t];
          
        }
      }
      Serial.print("We have ");
      Serial.print(TeamnameNumber);
      Serial.print(" teams");
      mValidTeamNamesField1 = TeamnameNumber;
      if(currentMatch_Field1 ==-1)
      {
        currentMatch_Field1 = 0;
      }
       Serial.print("Our current match is");
      Serial.println(currentMatch_Field1);
       NeedToSendMachData_1_CurrentMatch = true;
       NeedToSendMachData_1_NextMatch =true;

      //SetCurrentMatchField1(currentMatch_Field1);
      Serial.print("setted matchdata field 1");
    }
  }
};

//Need to connect matchdata with names


/*int currentMatch_Field1= -1;
int mValidTeamNamesField1 = 0;
*/

void UpdateScreenColor() {
  Serial.print("Update Screen Color ");
  Serial.println(mCurrentRadioID);
  mUpdateScreenColor = true;
  //Clear screen - as we change radio id
  tft.fillCircle(60, 90, 25, mRadioScores[mCurrentRadioID].BackgroundColor);
  tft.fillCircle(180, 90, 25, mRadioScores[mCurrentRadioID].BackgroundColor);
  //tft.drawRect(60, 85, 100, 30, TFT_RED);
  tft.fillRect(60, 65, 120, 51, mRadioScores[mCurrentRadioID].BackgroundColor);
  //tft.fillRect(60, 10, 30, 51, TFT_YELLOW);
   spr.createSprite(80, 40);
  spr.fillSprite(KC_grey);
  spr.pushSprite(80, 20);  // Push to TFT screen coord 10, 10
  //Middle in green
  spr.deleteSprite();
  spr.createSprite(90, 97);
  spr.fillSprite(KC_dirty_white);
  spr.pushSprite(75, 121);
  spr.deleteSprite();
}

void SendMatchDataLongToScoreBoard(int MatchNum)
{

}

void SendMatchDataShortToScoreBoard(int MatchNum)
{
  mMatchDataShort.FromRadioId = 0;
  mMatchDataShort.T1_Score = mRadioScores[MatchNum].mT1;
  mMatchDataShort.T2_Score = mRadioScores[MatchNum].mT2;
  mMatchDataShort.T1_Sets = mRadioScores[MatchNum].mS1;
  mMatchDataShort.T2_Sets = mRadioScores[MatchNum].mS2;
  mMatchDataShort.MatchNum =MatchNum+1;
  Serial.print("send data short to LED board ");
  
  if(_radio.send(8, &mMatchDataShort, sizeof(mMatchDataShort)))
  {
    Serial.println("...success");
  }
  else
  {
    Serial.println("...fail");
  }
}
//Communication with ScoreBoard


void setup(void) {
  Serial.begin(9600);
  //attachInterrupt(digitalPinToInterrupt(PIN_RADIO_IRQ), radioInterrupt, FALLING);
  pinMode(mDrehschalter._CLK,INPUT);
  pinMode(mDrehschalter._DT,INPUT);
  pinMode(mDrehschalter._SW,INPUT);
  
      /*if (!_radio.init(RADIO_ID, PIN_RADIO_CE, PIN_RADIO_CSN)) {
    Serial.println("Cannot communicate with radio");
    //while (1)
      ;  // Wait here forever.
  }*/
    if (!_radio.init(RADIO_ID, PIN_RADIO_CE, PIN_RADIO_CSN)) {
    Serial.println("Cannot communicate with radio");
    //while (1)
      ;  // Wait here forever.
  }
  tft.begin();

  mCurrentRadioID = 0;
  mRadioScores[0].BackgroundColor = 3697;
  mRadioScores[1].BackgroundColor = 61521;  //tft.color565(240,11,140);
  mRadioScores[2].BackgroundColor = 2142;   //tft.color565(11,11,240);
  //Serial.println(tft.color565(240,11,140));
  //Serial.println(tft.color565(11,11,240));
  //SPI.begin(PIN_RADIO_SCK, PIN_RADIO_MISO, PIN_RADIO_MOSI, PIN_RADIO_CSN);

  // Indicate to NRFLite that it should not call SPI.begin() during initialization since it has already been done.


  attachInterrupt(digitalPinToInterrupt(mDrehschalter._CLK), DrehschalterDreh1, CHANGE);
  tft.setRotation(TFT_ROT);

  spr.setColorDepth(16);  // 16 bit colour needed to show antialiased fonts

  tft.fillScreen(KC_grey);
  //tft.fillRect(0, 90, 240, 240, dirty_white);
  tft.fillCircle(60, 180, 90, KC_DARKGREY);
  tft.fillCircle(180, 180, 90, KC_DARKGREY);


  tft.fillCircle(60, 180, 88, KC_dirty_white);
  tft.fillCircle(180, 180, 88, KC_dirty_white);

  tft.fillRect(60, 90, 120, 240, KC_dirty_white);

  //tft.drawLine(50, 115, 0, 240, TFT_DARKGREY);
  //tft.drawLine(190, 115, 240, 240, TFT_DARKGREY);
  DrawVolleyball();
  DrawFox();
  //tft.drawCircle(120, 120, 120, TFT_DARKGREY);
  //tft.drawCircle(120, 120, 119, TFT_DARKGREY);
  tft.drawArc(120, 120, 120, 119, 270, 90, KC_DARKGREY, KC_DARKGREY);
  /*uint16_t bluish = tft.color565(11,206,140);
  Serial.println("redish");
  Serial.println(tft.color565(206,11,140));
    Serial.println("yellowish");
  Serial.println(tft.color565(206,140,11));*/
  /* start here*/
  //border
  tft.fillCircle(60, 90, 27, KC_DARKGREY);
  tft.fillCircle(180, 90, 27, KC_DARKGREY);
  tft.fillRect(60, 63, 120, 55, KC_DARKGREY);
  //real obj


  tft.fillCircle(60, 90, 25, mRadioScores[0].BackgroundColor);
  tft.fillCircle(180, 90, 25, mRadioScores[0].BackgroundColor);
  //tft.drawRect(60, 85, 100, 30, TFT_RED);
  tft.fillRect(60, 65, 120, 51, mRadioScores[0].BackgroundColor);

  //debug lines
  /*tft.drawLine(120, 0, 120, 240, TFT_RED);
  tft.drawLine(0, 120, 240, 120, TFT_RED);
    tft.drawLine(140, 0, 140, 240, TFT_RED);
      tft.drawLine(100, 0, 100, 240, TFT_RED);*/

  //request an radio update
  //have to do it after tft is setup... else we fail with listening


  /* BLE */
  // Create the BLE Device
  BLEDevice::init("ESP32");

  // Create the BLE Server
  pServer = BLEDevice::createServer();
  pServer->setCallbacks(new MyServerCallbacks());

  // Create the BLE Service
  BLEService* pService = pServer->createService(BLEUUID(SERVICE_UUID), 40, (uint8_t)0);

  // Create a BLE Characteristic
  pSensorCharacteristic = pService->createCharacteristic(
    SENSOR_CHARACTERISTIC_UUID,BLECharacteristic::PROPERTY_READ | BLECharacteristic::PROPERTY_WRITE | BLECharacteristic::PROPERTY_NOTIFY | BLECharacteristic::PROPERTY_INDICATE);

  // Create the ON button Characteristic
  pt1Characteristic = pService->createCharacteristic(T1_CHARACTERISTIC_UUID,BLECharacteristic::PROPERTY_WRITE);
  pt2Characteristic = pService->createCharacteristic(T2_CHARACTERISTIC_UUID, BLECharacteristic::PROPERTY_WRITE);
  ps1Characteristic = pService->createCharacteristic(S1_CHARACTERISTIC_UUID,BLECharacteristic::PROPERTY_WRITE);
  ps2Characteristic = pService->createCharacteristic(S2_CHARACTERISTIC_UUID,BLECharacteristic::PROPERTY_WRITE);
  cmdCharacteristic = pService->createCharacteristic(CMD_CHARACTERISTIC_UUID,BLECharacteristic::PROPERTY_WRITE);
  TeamNameCharacteristic = pService->createCharacteristic(mTeamNameCharaceristic,BLECharacteristic::PROPERTY_WRITE);
  TeamMathNumCharacteristics = pService->createCharacteristic(mTeamMatchNumCharaceristic,BLECharacteristic::PROPERTY_WRITE);
  // Register the callback for the ON button characteristic
  pt1Characteristic->setCallbacks(new MyCharacteristicCallbacks());
  pt2Characteristic->setCallbacks(new MyCharacteristicCallbacks2());
  ps1Characteristic->setCallbacks(new MyCharacteristicCallbacks3());
  ps2Characteristic->setCallbacks(new MyCharacteristicCallbacks4());
  cmdCharacteristic->setCallbacks(new MyCharacteristicCallbacksCMD());
  TeamNameCharacteristic->setCallbacks(new MyCharacteristicCallbacksTeamNames());
  TeamMathNumCharacteristics->setCallbacks(new MyCharacteristicCallbacksTeamMatch1());
  // https://www.bluetooth.com/specifications/gatt/viewer?attributeXmlFile=org.bluetooth.descriptor.gatt.client_characteristic_configuration.xml
  // Create a BLE Descriptor
  pSensorCharacteristic->addDescriptor(new BLE2902());
  pt1Characteristic->addDescriptor(new BLE2902());
  pt2Characteristic->addDescriptor(new BLE2902());
  ps1Characteristic->addDescriptor(new BLE2902());
  ps2Characteristic->addDescriptor(new BLE2902());
  cmdCharacteristic->addDescriptor(new BLE2902());
  TeamNameCharacteristic->addDescriptor(new BLE2902());
  TeamMathNumCharacteristics->addDescriptor(new BLE2902());
  // Start the service
  pService->start();

  // Start advertising
  BLEAdvertising* pAdvertising = BLEDevice::getAdvertising();
  pAdvertising->addServiceUUID(SERVICE_UUID);
  pAdvertising->setScanResponse(false);
  pAdvertising->setMinPreferred(0x0);  // set value to 0x00 to not advertise this parameter
  BLEDevice::startAdvertising();
  Serial.println("Waiting a client connection to notify...");
  _radioCmdData.CommandId = 0;
  _radio.send(mCurrentRadioID + 1, &_radioCmdData, sizeof(_radioCmdData));

  //test
}

void loop() {
  if(NeedToSendMachData_1_CurrentMatch)
  {
    NeedToSendMachData_1_CurrentMatch = false;
    SetCurrentMatchField1(currentMatch_Field1);
    return;
  }
  if(NeedToSendMachData_1_NextMatch)
  {
    NeedToSendMachData_1_NextMatch = false;
    SetNextMatchField1(currentMatch_Field1);
    return;
  }
  CheckInputState();
  if (mUpdateScreenColor) {
    UpdateScreenColor();
    mUpdateScreenColor = false;
    _radioCmdData.CommandId = 0;
    //update my score pls
    _radio.send(mCurrentRadioID + 1, &_radioCmdData, sizeof(_radioCmdData));
    Serial.println("we sent cmd to radio");
    return;
  }
  if (NeedToNotifyTFT) {
    Serial.println("need to notify tft");
    //in this case we only call this fct from BLE
    SetNewScore(mRadioScores[mCurrentRadioID].mT1, mRadioScores[mCurrentRadioID].mT2, mRadioScores[mCurrentRadioID].mS1, mRadioScores[mCurrentRadioID].mS2);
    NeedToNotifyTFT = false;
    //no return?
    //and multiple tasks allowed?
    //finally update Scoreboard
    
  }
  /*if(Serial.available()) 
    {
  // TODO
    Serial.read();
    _radio.send(DESTINATION_RADIO_ID, &_radioCmdData, sizeof(_radioCmdData));
    
    Serial.println("serial av");
    }*/
  if (NeedToNotifyRadio) {
    Serial.println("Inform Radio now");
    _radioCmdData.CommandId = 1;
    _radioCmdData.CommandArg1 = mRadioScores[mCurrentRadioID].mT1;
    _radioCmdData.CommandArg2 = mRadioScores[mCurrentRadioID].mT2;
    _radioCmdData.CommandArg3 = mRadioScores[mCurrentRadioID].mS1;
    _radioCmdData.CommandArg4 = mRadioScores[mCurrentRadioID].mS2;
    _radio.send(mCurrentRadioID + 1, &_radioCmdData, sizeof(_radioCmdData));
    NeedToNotifyRadio = false;

  } else if (CommandMode.MessageRecieved) {
    _radioCmdData.CommandId = CommandMode.CommandId;
    _radioCmdData.CommandArg1 = CommandMode.Arg1;
    CommandMode.MessageRecieved = false;
    _radio.send(mCurrentRadioID + 1, &_radioCmdData, sizeof(_radioCmdData));
    Serial.println("Send a Cmd");
  }
  uint8_t packetSize = _radio.hasData();
  if(packetSize > 0)
  {
    Serial.print("we recieved data ");
    Serial.println(packetSize);
  }
  if (packetSize == sizeof(RadioScorePacket)) {
    _radio.readData(&_radioData);
    uint8_t sender = _radioData.FromRadioId - 1;
    /*String msg = "Radio ";
        msg += _radioData.FromRadioId;
        msg += ", ";
        msg += _radioData.T1_Score;
        msg += " : ";
        msg += _radioData.T2_Score;
        msg += " sets: ";
        msg += _radioData.T1_Sets;
        msg += " : ";
        msg += _radioData.T2_Sets;*/
    //Serial.println(msg);
    mRadioScores[sender].mT1 = _radioData.T1_Score;
    mRadioScores[sender].mT2 = _radioData.T2_Score;
    mRadioScores[sender].mS1 = _radioData.T1_Sets;
    mRadioScores[sender].mS2 = _radioData.T2_Sets;
    if (sender == mCurrentRadioID)  //only update if we have same radio id ... i.e. we selected to "show" the radio data
    {
      SetNewScore(_radioData.T1_Score, _radioData.T2_Score, _radioData.T1_Sets, _radioData.T2_Sets);
      NeedToNotifyBLE = true;
    }
    NeedToNotifyLEDShort = true; //we may specify which matchdata
  } else if (packetSize == sizeof(RadioHistoryPacket)) {

    uint8_t t1_won = 0;
    uint8_t t2_won = 0;
    _radio.readData(&_radioHistoryData);
    uint8_t sender = _radioData.FromRadioId - 1;
    Serial.println("Verlauf:");
    if (_radioHistoryData.myVolleyBallHistory[0].Set == false) {
      Serial.print("Keine Sätze gespielt");
      return;
    }
    for (size_t t = 0; t < 5; t++) {
      if (!_radioHistoryData.myVolleyBallHistory[t].Set)
        continue;
      Serial.print("(");
      Serial.print(_radioHistoryData.myVolleyBallHistory[t].Satz);
      Serial.print(") ");
      Serial.print(_radioHistoryData.myVolleyBallHistory[t].Team1);
      Serial.print(" : ");
      Serial.println(_radioHistoryData.myVolleyBallHistory[t].Team2);
      if (_radioHistoryData.myVolleyBallHistory[t].Winner <= 1) {
        t1_won++;
      }
      if (_radioHistoryData.myVolleyBallHistory[t].Winner == 2 || _radioHistoryData.myVolleyBallHistory[t].Winner == 0) {
        t2_won++;
      }
    }
    for (uint8_t t = 0; t < 5; t++) {
      mRadioScores[sender].MyVolleyHistory[t] = _radioHistoryData.myVolleyBallHistory[t];
    }
    if (sender == mCurrentRadioID) {
      UpdateHistory(_radioHistoryData.myVolleyBallHistory, 5, sender);
      Serial.print("Satzverhaeltnis Radio");
      Serial.println(sender);
      Serial.print(t1_won);
      Serial.print(" : ");
      Serial.println(t2_won);
    }  //else silent update
  } else if (packetSize != 0) {
    // We have a packet with an unexpected size, either an invalid packet or packet
    // that was sent from a radio that we cannot handle, so remove it from the radio.

    Serial.print("Received packet with length '");
    Serial.print(packetSize);
    Serial.println("', it will be discarded");

    _radio.discardData(packetSize);
  }
  /* BLE*/
  else {
    if (deviceConnected && m_BLETime + 50 < millis() && NeedToNotifyBLE) {
      String i = "0,";
      char buffer[2];  //the ASCII of the integer will be stored in this char array
      i = i + mRadioScores[mCurrentRadioID].mT1 + ",";
      i = i + mRadioScores[mCurrentRadioID].mT2 + ",";
      i = i + mRadioScores[mCurrentRadioID].mS1 + ",";
      i = i + mRadioScores[mCurrentRadioID].mS2;
      Serial.println(i);
      pSensorCharacteristic->setValue(i.c_str());
      pSensorCharacteristic->notify();
      m_BLETime = millis();
      NeedToNotifyBLE = false;
      //value++;
      //Serial.print("New value notified: ");
      //Serial.println(value);
    }
    // disconnecting
    if (!deviceConnected && oldDeviceConnected && m_BLETime + 500 < millis()) {
      Serial.println("Device disconnected.");
      pServer->startAdvertising();  // restart advertising
      Serial.println("Start advertising");
      oldDeviceConnected = deviceConnected;
      m_BLETime = millis();
    }
    // connecting
    if (deviceConnected && !oldDeviceConnected) {
      // do stuff here on connecting
      oldDeviceConnected = deviceConnected;
      Serial.println("Device Connected");
    }
  }
  //maybe LED screen need update
  if(NeedToNotifyLEDShort)
  {
    NeedToNotifyLEDShort = false;
    SendMatchDataShortToScoreBoard(mCurrentRadioID);
  }
  return;
}


void radioInterrupt()
{
    // Ask the radio what caused the interrupt.  This also resets the IRQ pin on the
    // radio so a new interrupt can be triggered.

    uint8_t txOk, txFail, rxReady;
    _radio.whatHappened(txOk, txFail, rxReady);

    // txOk = the radio successfully transmitted data.
    // txFail = the radio failed to transmit data.
    // rxReady = the radio received data.

    if (rxReady)
    {
        //_dataWasReceived = true;
        Serial.println("we recieved data");
    }
}


void UpdateHistory(VolleyBallHistory TheArray[], int n, int sender) {
  int xpos = tft.width() / 2;  // Half the screen width
  int ypos = 50;
  int counter = 5;
  int MaxSpace = counter * 19 + 2;
  spr.createSprite(90, MaxSpace);
  spr.fillSprite(KC_dirty_white);
  spr.setTextColor(TFT_BLACK, KC_DARKGREY);
  spr.loadFont(AA_FONT_SMALL);
  //spr.loadFont(AA_FONT_MONO);
  for (size_t i = 0; i < n; i++) {
    if (!TheArray[i].Set) {

    } else {
      //spr.drawString("(1)",5,i*20);
      spr.print("(");
      int j = TheArray[i].Satz + 1;
      spr.print(j);
      spr.print(") ");
      j = (int)TheArray[i].Team1;
      spr.printf("%02d : ", j);
      j = (int)TheArray[i].Team2;
      spr.printf("%02d", j);
      spr.println("");
      /*spr.drawString("02",30,i*20);
      spr.drawString(":",55,i*20);
       spr.drawString("15",65,i*20);*/
    }
  }
  spr.pushSprite(75, 121);
  spr.deleteSprite();
  /*if(counter <= 3)
  {
    spr.deleteSprite();
    spr.loadFont(AA_FONT_MONO);
    spr.setTextSize(10);
    spr.createSprite(135, 20);
    spr.fillSprite(dirty_white);
    spr.drawString("Beachfreunde",0,0);
    spr.pushSprite(58, 190); 
    spr.deleteSprite();
    spr.createSprite(48,20);
    spr.fillSprite(dirty_white);
    
    //ö  = 0 + zwei Punkte
    spr.drawString("Pohl",0,0);
    spr.fillCircle(14,3,1,TFT_BLACK);
    spr.fillCircle(18,3,1,TFT_BLACK);
    spr.pushSprite(100, 210); 
  }*/
}
void SetNewScore(int T1, int T2, int S1, int S2) {
  int xpos = tft.width() / 2;  // Half the screen width
  int ypos = 50;
  delay(20);

  spr.loadFont(AA_FONT_LARGE);
  spr.createSprite(80, 40);
  spr.fillSprite(KC_grey);
  spr.setTextColor(KC_dirty_white, KC_DARKGREY);
  spr.drawNumber(S1, 0, 00);
  spr.drawString(":", 35, 00);
  spr.drawNumber(S2, 60, 0);
  spr.pushSprite(80, 20);  // Push to TFT screen coord 10, 10
  //Middle in green
  spr.deleteSprite();
  spr.createSprite(124, 45);
  spr.setTextColor(TFT_WHITE, KC_DARKGREY);
  spr.fillSprite(mRadioScores[mCurrentRadioID].BackgroundColor);
  if (T1 < 10) {
    spr.drawNumber(0, 0, 10);
    spr.drawNumber(T1, 22, 10);
  } else
    spr.drawNumber(T1, 0, 10);
  spr.drawString(":", 55, 10);
  if (T2 < 10) {
    spr.drawNumber(0, 80, 10);
    spr.drawNumber(T2, 102, 10);
  } else
    spr.drawNumber(T2, 80, 10);
  spr.pushSprite(60, 67);
  spr.deleteSprite();
}

void DrawVolleyball() {
  uint16_t m_counter = 0;
  uint8_t NewY = 0;
  uint8_t NewX = 0;
  for (int i = 0; i < 2500; i++) {
    if (m_counter >= 50) {
      m_counter = m_counter - 1;
      NewY++;
      NewX = 0;
      m_counter = 0;
    }
    if (61309 != volleyball[i])
      tft.drawPixel(NewX + xpos_volleyball, NewY + ypos_volleyball, volleyball[i]);
    NewX++;
    m_counter++;
  }
}


void DrawFox() {
  uint16_t m_counter = 0;
  uint8_t NewY = 0;
  uint8_t NewX = 0;
  //53 * 50
  for (int i = 0; i < 2650; i++) {
    if (m_counter >= 53) {
      m_counter = m_counter - 1;
      NewY++;
      NewX = 0;
      m_counter = 0;
    }
    if (61309 != fox_pic[i])
      tft.drawPixel(NewX + xpos_fox, NewY + ypos_fox, fox_pic[i]);
    NewX++;
    m_counter++;
  }
}

void DrehschalterDreh1() {
  //Serial.println("Dreh1");
  mDrehschalter.CLK_Wert_n = digitalRead(mDrehschalter._CLK);
  mDrehschalter.Relative_Position = digitalRead(mDrehschalter._DT);
}

/*
struct Drehschalter
{
  DrehPosition = 0;
  int Relative_Position = LOW;
  int Old_Relative_Position = LOW;
  int CLK_Wert_n = LOW;
  int Current_Taster = LOW;
  int Old_Taster = LOW;
  bool WasUpdated = false;
  ButtonPressedTime
};
*/
bool CheckInputState()  //return Anything changed? But only for one Rotary Encoder
{
  bool AnythingChanged = false;
  //this is done in interrupt now (faster updates?)
  //n = digitalRead(CLK);
  mDrehschalter.Current_Taster = !digitalRead(mDrehschalter._SW);

  /* long press Button -> submit set*/
  if (mDrehschalter.Current_Taster == false) {
    //Serial.println("Button not pressed");
    

    mDrehschalter.ButtonPressedTime = millis();
  } else if (mDrehschalter.Old_Taster) { 

    //long button press
    if (millis() - 1000 > mDrehschalter.ButtonPressedTime) {
      //Submit Sentence
      Serial.println("Submit a buttom change");
      mDrehschalter.ButtonPressedTime = millis() + 10000;
      mDrehschalter.OnLongPressButton = true;
      //HandleSetFinished();
      return true;
    }
  }

  if (mDrehschalter.Old_Taster != mDrehschalter.Current_Taster) {
    Serial.print(mDrehschalter.DrehPosition);
    Serial.print("|");
    Serial.print(mDrehschalter.Current_Taster);
    mDrehschalter.Old_Taster = mDrehschalter.Current_Taster;
    //this tells us to go in another mode
    if (mDrehschalter.OnLongPressButton)  //do not go in next mode if we long pressed button
    {
      mDrehschalter.OnLongPressButton = false;
      return false;
    }
    if (mDrehschalter.Old_Taster == false) {
      //short button press
      AnythingChanged = true;

      mCurrentRadioID = mCurrentRadioID + 1;
      if (mCurrentRadioID >= 3)
        mCurrentRadioID = 0;
        mUpdateScreenColor = true;
      Serial.print("|");
      Serial.println(mCurrentRadioID);
    }
  }
  if ((mDrehschalter.Old_Relative_Position == LOW) && (mDrehschalter.CLK_Wert_n == HIGH)) {
    if (mDrehschalter.Relative_Position == LOW) {
      mDrehschalter.DrehPosition++;
      //ModifyColor(true);
    } else {
       mDrehschalter.DrehPosition--;
      //ModifyColor(false);
    }
    Serial.print( mDrehschalter.DrehPosition);
    Serial.print("|");
    Serial.print(mDrehschalter.Current_Taster);
    Serial.print("|");
    Serial.println(mCurrentRadioID);
    AnythingChanged = true;
  }
  mDrehschalter.Old_Relative_Position = mDrehschalter.CLK_Wert_n;
  return AnythingChanged;
}

/*
struct __attribute__((packed)) MatchDataLong  // Any packet up to 32 bytes can be sent.
{
  uint8_t FromRadioId;
  uint8_t MatchNum; //we can track 3 matches
  uint8_t T1_Score = 2;
  uint8_t T2_Score = 3;
  uint8_t T1_Sets = 1 ;
  uint8_t T2_Sets = 2;
  char TeamName1[12] ;
  char TeamName2[12];
  uint32_t FailedTxCount;
};

struct __attribute__((packed)) MatchDataShort  // Any packet up to 32 bytes can be sent.
{
  uint8_t FromRadioId;
  uint8_t MatchNum; //we can track 3 matches
  uint8_t T1_Score = 2;
  uint8_t T2_Score = 3;
  uint8_t T1_Sets = 1 ;
  uint8_t T2_Sets = 2;
  uint32_t FailedTxCount;
};
*/
